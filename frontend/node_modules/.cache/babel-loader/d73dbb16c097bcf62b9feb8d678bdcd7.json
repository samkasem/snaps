{"ast":null,"code":"import _slicedToArray from\"D:/Projects/snaps/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import{Link,useNavigate}from'react-router-dom';import{v4 as uuidv4}from'uuid';import{MdDownloadForOffline}from'react-icons/md';import{AiTwotoneDelete}from'react-icons/ai';import{BsFillArrowUpRightCircleFill}from'react-icons/bs';import{client,urlfor}from'../client';import{fetchUser}from'../utils/fetchUser';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Snap=function Snap(_ref){var _snap$save,_alreadySaved,_image$asset,_alreadySaved3,_snap$save2,_snap$save3;var snap=_ref.snap;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),postHovered=_useState2[0],setPostHovered=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),savingPost=_useState4[0],setSavingPost=_useState4[1];var navigate=useNavigate();var postedBy=snap.postedBy,image=snap.image,_id=snap._id,destination=snap.destination;var user=fetchUser();var deletSnap=function deletSnap(id){client.delete(id).then(function(){window.location.reload();});};var alreadySaved=snap===null||snap===void 0?void 0:(_snap$save=snap.save)===null||_snap$save===void 0?void 0:_snap$save.filter(function(item){var _item$postedBy;return(item===null||item===void 0?void 0:(_item$postedBy=item.postedBy)===null||_item$postedBy===void 0?void 0:_item$postedBy._id)===(user===null||user===void 0?void 0:user.googleId);});alreadySaved=((_alreadySaved=alreadySaved)===null||_alreadySaved===void 0?void 0:_alreadySaved.length)>0?alreadySaved:[];var saveSnap=function saveSnap(id){var _alreadySaved2;if(((_alreadySaved2=alreadySaved)===null||_alreadySaved2===void 0?void 0:_alreadySaved2.length)===0){setSavingPost(true);client.patch(id).setIfMissing({save:[]}).insert('after','save[-1]',[{_key:uuidv4(),userId:user===null||user===void 0?void 0:user.googleId,postedBy:{_type:'postedBy',_ref:user===null||user===void 0?void 0:user.googleId}}]).commit().then(function(){window.location.reload();setSavingPost(false);});}};return/*#__PURE__*/_jsxs(\"div\",{className:\"m-2\",children:[/*#__PURE__*/_jsxs(\"div\",{onMouseEnter:function onMouseEnter(){return setPostHovered(true);},onMouseLeave:function onMouseLeave(){return setPostHovered(false);},onClick:function onClick(){return navigate(\"snap-detail/\".concat(_id));},className:\" relative cursor-zoom-in w-auto hover:shadow-lg rounded-lg overflow-hidden transition-all duration-500 ease-in-out\",children:[image&&/*#__PURE__*/_jsx(\"img\",{className:\"rounded-lg w-full \",src:urlfor(image).width(250).url(),alt:\"user-post\"}),postHovered&&/*#__PURE__*/_jsxs(\"div\",{className:\"absolute top-0 w-full h-full flex flex-col justify-between p-1 pr-2 pt-2 pb-2 z-50\",style:{height:'100%'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"flex gap-2\",children:/*#__PURE__*/_jsx(\"a\",{href:\"\".concat(image===null||image===void 0?void 0:(_image$asset=image.asset)===null||_image$asset===void 0?void 0:_image$asset.url,\"?dl=\"),download:true,onClick:function onClick(e){e.stopPropagation();},className:\"bg-white w-9 h-9 p-2 rounded-full flex items-center justify-center text-dark text-xl opacity-75 hover:opacity-100 hover:shadow-md outline-none\",children:/*#__PURE__*/_jsx(MdDownloadForOffline,{})})}),((_alreadySaved3=alreadySaved)===null||_alreadySaved3===void 0?void 0:_alreadySaved3.length)!==0?/*#__PURE__*/_jsxs(\"button\",{type:\"button\",className:\"bg-yellow-500 opacity-70 hover:opacity-100 text-white font-bold px-5 py-1 text-base rounded-3xl hover:shadow-md outline-none\",children:[snap===null||snap===void 0?void 0:(_snap$save2=snap.save)===null||_snap$save2===void 0?void 0:_snap$save2.length,\" Saved\"]}):/*#__PURE__*/_jsxs(\"button\",{onClick:function onClick(e){e.stopPropagation();saveSnap(_id);},type:\"button\",className:\"bg-yellow-500 opacity-70 hover:opacity-100 text-white font-bold px-5 py-1 text-base rounded-3xl hover:shadow-md outline-none\",children:[snap===null||snap===void 0?void 0:(_snap$save3=snap.save)===null||_snap$save3===void 0?void 0:_snap$save3.length,\" \",savingPost?'Saving':'Save']})]}),/*#__PURE__*/_jsx(\"div\",{className:\" flex justify-between items-center gap-2 w-full\",children:(postedBy===null||postedBy===void 0?void 0:postedBy._id)===(user===null||user===void 0?void 0:user.googleId)&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:function onClick(e){e.stopPropagation();deletSnap(_id);},className:\"bg-white p-2 rounded-full w-8 h-8 flex items-center justify-center text-dark opacity-75 hover:opacity-100 outline-none\",children:/*#__PURE__*/_jsx(AiTwotoneDelete,{})})})]})]}),/*#__PURE__*/_jsxs(Link,{to:\"/user-profile/\".concat(postedBy===null||postedBy===void 0?void 0:postedBy._id),className:\"flex gap-2 mt-2 items-center\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"w-8 h-8 rounded-full object-cover\",src:postedBy===null||postedBy===void 0?void 0:postedBy.image,alt:\"user-profile\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-semibold capitalize\",children:postedBy===null||postedBy===void 0?void 0:postedBy.userName})]})]});};export default Snap;","map":{"version":3,"names":["React","useState","Link","useNavigate","v4","uuidv4","MdDownloadForOffline","AiTwotoneDelete","BsFillArrowUpRightCircleFill","client","urlfor","fetchUser","Snap","snap","postHovered","setPostHovered","savingPost","setSavingPost","navigate","postedBy","image","_id","destination","user","deletSnap","id","delete","then","window","location","reload","alreadySaved","save","filter","item","googleId","length","saveSnap","patch","setIfMissing","insert","_key","userId","_type","_ref","commit","width","url","height","asset","e","stopPropagation","userName"],"sources":["D:/Projects/snaps/frontend/src/components/Snap.jsx"],"sourcesContent":["import React, { useState } from 'react'\r\nimport { Link, useNavigate } from 'react-router-dom'\r\nimport { v4 as uuidv4 } from 'uuid'\r\nimport { MdDownloadForOffline } from 'react-icons/md'\r\nimport { AiTwotoneDelete } from 'react-icons/ai'\r\nimport { BsFillArrowUpRightCircleFill } from 'react-icons/bs'\r\n\r\nimport { client, urlfor } from '../client'\r\nimport { fetchUser } from '../utils/fetchUser'\r\n\r\nconst Snap = ({ snap }) => {\r\n  const [postHovered, setPostHovered] = useState(false)\r\n  const [savingPost, setSavingPost] = useState(false)\r\n\r\n  const navigate = useNavigate()\r\n\r\n  const { postedBy, image, _id, destination } = snap\r\n\r\n  const user = fetchUser()\r\n\r\n  const deletSnap = (id) => {\r\n    client.delete(id).then(() => {\r\n      window.location.reload()\r\n    })\r\n  }\r\n\r\n  let alreadySaved = snap?.save?.filter(\r\n    (item) => item?.postedBy?._id === user?.googleId\r\n  )\r\n\r\n  alreadySaved = alreadySaved?.length > 0 ? alreadySaved : []\r\n\r\n  const saveSnap = (id) => {\r\n    if (alreadySaved?.length === 0) {\r\n      setSavingPost(true)\r\n\r\n      client\r\n        .patch(id)\r\n        .setIfMissing({ save: [] })\r\n        .insert('after', 'save[-1]', [\r\n          {\r\n            _key: uuidv4(),\r\n            userId: user?.googleId,\r\n            postedBy: {\r\n              _type: 'postedBy',\r\n              _ref: user?.googleId,\r\n            },\r\n          },\r\n        ])\r\n        .commit()\r\n        .then(() => {\r\n          window.location.reload()\r\n          setSavingPost(false)\r\n        })\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className='m-2'>\r\n      <div\r\n        onMouseEnter={() => setPostHovered(true)}\r\n        onMouseLeave={() => setPostHovered(false)}\r\n        onClick={() => navigate(`snap-detail/${_id}`)}\r\n        className=' relative cursor-zoom-in w-auto hover:shadow-lg rounded-lg overflow-hidden transition-all duration-500 ease-in-out'\r\n      >\r\n        {image && (\r\n          <img\r\n            className='rounded-lg w-full '\r\n            src={urlfor(image).width(250).url()}\r\n            alt='user-post'\r\n          />\r\n        )}\r\n        {postHovered && (\r\n          <div\r\n            className='absolute top-0 w-full h-full flex flex-col justify-between p-1 pr-2 pt-2 pb-2 z-50'\r\n            style={{ height: '100%' }}\r\n          >\r\n            <div className='flex items-center justify-between'>\r\n              <div className='flex gap-2'>\r\n                <a\r\n                  href={`${image?.asset?.url}?dl=`}\r\n                  download\r\n                  onClick={(e) => {\r\n                    e.stopPropagation()\r\n                  }}\r\n                  className='bg-white w-9 h-9 p-2 rounded-full flex items-center justify-center text-dark text-xl opacity-75 hover:opacity-100 hover:shadow-md outline-none'\r\n                >\r\n                  <MdDownloadForOffline />\r\n                </a>\r\n              </div>\r\n              {alreadySaved?.length !== 0 ? (\r\n                <button\r\n                  type='button'\r\n                  className='bg-yellow-500 opacity-70 hover:opacity-100 text-white font-bold px-5 py-1 text-base rounded-3xl hover:shadow-md outline-none'\r\n                >\r\n                  {snap?.save?.length} Saved\r\n                </button>\r\n              ) : (\r\n                <button\r\n                  onClick={(e) => {\r\n                    e.stopPropagation()\r\n                    saveSnap(_id)\r\n                  }}\r\n                  type='button'\r\n                  className='bg-yellow-500 opacity-70 hover:opacity-100 text-white font-bold px-5 py-1 text-base rounded-3xl hover:shadow-md outline-none'\r\n                >\r\n                  {snap?.save?.length} {savingPost ? 'Saving' : 'Save'}\r\n                </button>\r\n              )}\r\n            </div>\r\n            <div className=' flex justify-between items-center gap-2 w-full'>\r\n              {postedBy?._id === user?.googleId && (\r\n                <button\r\n                  type='button'\r\n                  onClick={(e) => {\r\n                    e.stopPropagation()\r\n                    deletSnap(_id)\r\n                  }}\r\n                  className='bg-white p-2 rounded-full w-8 h-8 flex items-center justify-center text-dark opacity-75 hover:opacity-100 outline-none'\r\n                >\r\n                  <AiTwotoneDelete />\r\n                </button>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n      </div>\r\n      <Link\r\n        to={`/user-profile/${postedBy?._id}`}\r\n        className='flex gap-2 mt-2 items-center'\r\n      >\r\n        <img\r\n          className='w-8 h-8 rounded-full object-cover'\r\n          src={postedBy?.image}\r\n          alt='user-profile'\r\n        />\r\n        <p className='font-semibold capitalize'>{postedBy?.userName}</p>\r\n      </Link>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Snap\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}